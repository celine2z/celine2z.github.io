
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ÏïΩÎ¨º Í≥ÑÏÇ∞Í∏∞</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      margin: 16px;
      padding: 0 0 24px 0;
      background: #f9f9f9;
      text-align: center;
      font-weight: 500;
    }
    .section {
      margin-bottom: 14px;
    }
    .section-title {
      font-size: 15px;
      margin: 10px 0 5px;
      font-weight: bold;
    }
    .drug-buttons, .concentration-buttons, .dose-buttons {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      max-width: 400px;
      margin: 0 auto;
    }
    .drug-button {
      padding: 12px;
      border-radius: 10px;
      font-size: 14px;
      border: none;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }
    .blue { background-color: #d0eaff; color: #003366; }
    .pink { background-color: #ffe0f0; color: #880044; }
    .blue.selected { background-color: #007bff; color: white; }
    .pink.selected { background-color: #b4005a; color: white; }

    .conc-button, .dose-button {
      padding: 10px 12px;
      border-radius: 8px;
      font-size: 13px;
      border: none;
      cursor: pointer;
    }
    .conc-button { background-color: #e0e0e0; color: #333; }
    .conc-button.selected { background-color: #555; color: white; }
    .dose-button { background-color: #e0ffe0; color: #005500; }
    .dose-button.selected { background-color: #00aa00; color: white; }

    #resultBox {
      margin-top: 2px;
      font-size: 22px;
      font-weight: bold;
      color: red;
      background-color: white;
      border-radius: 8px;
      padding: 14px;
      border: 1px solid #ccc;
      display: inline-block;
      min-width: 160px;
    }      position: sticky;
      bottom: 14px;
      z-index: 10;
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      margin-top: 10px;
    }

    input[type="number"] {
      padding: 8px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-bottom: 8px;
      width: 150px;
    }
  </style>
</head>
<body>

  <h2>üíâ ÏïΩÎ¨º Í≥ÑÏÇ∞Í∏∞</h2>

  <div class="section">
    <label for="weight">Ï≤¥Ï§ë (kg): </label>
    <input type="number" id="weight" placeholder="Ïòà: 70" />
  </div>

  <div class="section drug-buttons">
    <button class="drug-button blue" data-drug="norepi">Norepi/Epi</button>
    <button class="drug-button blue" data-drug="dopa">Dopa/Dobu</button>
    <button class="drug-button blue" data-drug="phenyl">Phenyl</button>
    <button class="drug-button blue" data-drug="ntg">NTG</button>
    <button class="drug-button pink" data-drug="byfavo">Byfavo</button>
    <button class="drug-button pink" data-drug="precedex">Precedex</button>
  </div>

  <div class="section" style="margin-top: 25px;" id="selectedDrugDisplay">ÏÑ†ÌÉùÌïú ÏïΩÎ¨º: </div>

  <div class="section">
    <div class="section-title">ÎÜçÎèÑ ÏÑ†ÌÉù:</div>
    <div class="concentration-buttons" id="concentrationButtons"></div>
    <div id="norepiMixInfo" style="margin-top:8px;font-size:13px;color:#333;line-height:1.35;"></div>
  </div>

  <div class="section">
    <div class="section-title">Ïö©Îüâ ÏÑ†ÌÉù:</div>
    <div class="dose-buttons" id="doseButtons"></div>
  </div>

  <div id="resultBox"></div>

  <script>
    const drugNames = {
      norepi: "Norepinephrine / Epinephrine",
      dopa: "Dopamine / Dobutamine",
      phenyl: "Phenylephrine",
      ntg: "Nitroglycerin",
      byfavo: "Remimazolam (Byfavo)",
      precedex: "Precedex (4mcg/ml)"
    };

    const concentrationMap = {
      norepi: [5, 10, 20, 60],
      phenyl: [100],
      dopa: [2],
      ntg: [250],
      byfavo: [1, 2],
      precedex: [4]
    };

    const doseMap = {
      norepi: [0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.1],
      phenyl: [0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0],
      dopa: [1,2,3,4,5,10],
      ntg: [0.5,1,2,5],
      byfavo: ['Ïú†ÎèÑ 6~12mg/kg/hr','Ïú†ÏßÄ 1~2mg/kg/hr','MAC 0.1~0.2mg/kg/hr'],
      precedex: [0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0]
    };

    
    const norepiMixMap = {
      5:  "D5W 100ml + Norepi/Epi 0.5ml<br>(Ïã§Ï†ú: D5W 99.5ml + Norepi/Epi 0.5ml)",
      10: "D5W 100ml + Norepi/Epi 1ml<br>(Ïã§Ï†ú: D5W 99ml + Norepi/Epi 1ml)",
      20: "D5W 100ml + Norepi/Epi 2ml<br>(Ïã§Ï†ú: D5W 98ml + Norepi/Epi 2ml)",
      60: "D5W 100ml + Norepi/Epi 6ml<br>(Ïã§Ï†ú: D5W 94ml + Norepi/Epi 6ml)"
    };

    const drugUnits = {
      norepi: "mcg",
      phenyl: "mcg",
      dopa: "mg",
      ntg: "mcg",
      byfavo: "mg",
      precedex: "mcg"
    };

    let selectedDrug = '';
    let selectedConcentration = null;
    let selectedDose = null;

    document.querySelectorAll('.drug-button').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.drug-button').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        selectedDrug = btn.getAttribute('data-drug');
        selectedConcentration = null;
        selectedDose = null;
        document.getElementById("selectedDrugDisplay").innerText = "ÏÑ†ÌÉùÌïú ÏïΩÎ¨º: " + drugNames[selectedDrug];
        renderConcentrationButtons();
        renderDoseButtons();
        document.getElementById("resultBox").innerText = '';
        const mixDiv = document.getElementById('norepiMixInfo'); if (mixDiv) mixDiv.innerHTML = '';
      });
    });

    function renderConcentrationButtons() {
      const container = document.getElementById("concentrationButtons");
      container.innerHTML = '';
      const mixDiv = document.getElementById('norepiMixInfo');
      if (mixDiv && selectedDrug !== 'norepi') mixDiv.innerHTML = '';
      (concentrationMap[selectedDrug] || []).forEach(value => {
        const btn = document.createElement('button');
        btn.className = 'conc-button';
        let unitText = `${value} ${drugUnits[selectedDrug]}/ml`;
        if (selectedDrug === 'dopa') unitText = "2 mg/ml";
        btn.innerText = unitText;
        btn.onclick = () => {
          document.querySelectorAll('.conc-button').forEach(b => b.classList.remove('selected'));
          btn.classList.add('selected');
          selectedConcentration = value;

          if (selectedDrug === 'norepi') {
            const mixDiv = document.getElementById('norepiMixInfo');
            if (mixDiv) mixDiv.innerHTML = norepiMixMap[value] || '';
          } else {
            const mixDiv = document.getElementById('norepiMixInfo');
            if (mixDiv) mixDiv.innerHTML = '';
          }

          document.getElementById("resultBox").innerText = '';
        };
        container.appendChild(btn);
      });
    }

    function renderDoseButtons() {
      const container = document.getElementById("doseButtons");
      container.innerHTML = '';
      (doseMap[selectedDrug] || []).forEach(value => {
        const btn = document.createElement('button');
        btn.className = 'dose-button';
        btn.innerText = value.toString();
        btn.onclick = () => {
          document.querySelectorAll('.dose-button').forEach(b => b.classList.remove('selected'));
          btn.classList.add('selected');
          selectedDose = value;
          calculate();
        };
        container.appendChild(btn);
      });
    }

    function calculate() {
      const weight = parseFloat(document.getElementById("weight").value);
      if (!weight || !selectedConcentration || !selectedDose) return;

      let resultText = '';

      if (selectedDrug === 'byfavo') {
        let min, max;
        if (selectedDose.startsWith('Ïú†ÎèÑ')) { min = 6; max = 12; }
        else if (selectedDose.startsWith('Ïú†ÏßÄ')) { min = 1; max = 2; }
        else if (selectedDose.startsWith('MAC')) { min = 0.1; max = 0.2; }

        const low = (weight * min / selectedConcentration).toFixed(2);
        const high = (weight * max / selectedConcentration).toFixed(2);
        resultText = `${low} ~ ${high} ml/hr`;
      } else if (selectedDrug === 'precedex') {
        const dose = parseFloat(selectedDose);
        const mcgPerHr = weight * dose;
        const mlPerHr = (mcgPerHr / selectedConcentration).toFixed(2);
        resultText = `${mlPerHr} ml/hr`;
      } else if (selectedDrug === 'dopa') {
        const dose = parseFloat(selectedDose);
        const mcgPerHr = weight * dose * 60;
        const mlPerHr = (mcgPerHr / 2000).toFixed(2); // 2mg/ml = 2000mcg/ml
        resultText = `${mlPerHr} ml/hr`;
      } else {
        const dose = parseFloat(selectedDose);
        const mcgPerHr = weight * dose * 60;
        const mlPerHr = (mcgPerHr / selectedConcentration).toFixed(2);
        resultText = `${mlPerHr} ml/hr`;
      }

      document.getElementById("resultBox").innerText = resultText;
    }
  </script>

</body>
</html>

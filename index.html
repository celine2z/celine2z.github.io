
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>약물 계산기</title>
  <style>
    body {
      font-family: Arial;
      margin: 30px;
      text-align: center;
    }
    input[type="number"] {
      padding: 10px;
      font-size: 16px;
      width: 120px;
    }
    .section {
      margin-bottom: 10px;
    }
    .drug-buttons, .concentration-buttons, .dose-buttons {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 5px;
    }
    .btn {
      padding: 10px 16px;
      border: none;
      cursor: pointer;
      border-radius: 5px;
      font-size: 14px;
      min-width: 160px;
    }
    .drug-blue {
      background-color: #a4c8f0;
      color: white;
    }
    .drug-blue.selected {
      background-color: #2471A3;
    }
    .drug-pink {
      background-color: #f8b6cc;
      color: white;
    }
    .drug-pink.selected {
      background-color: #a40063;
    }
    .concentration-btn {
      background-color: #ddd;
      color: black;
    }
    .concentration-btn.selected {
      background-color: #444;
      color: yellow;
    }
    .dose-btn {
      background-color: #e6ffe6;
    }
    .dose-btn.selected {
      background-color: #4CAF50;
      color: white;
    }
    .result {
      margin-top: 20px;
      font-size: 18px;
      font-weight: bold;
      color: darkred;
    }
  </style>
</head>
<body>
  <h2>💉 약물 계산기</h2>

  <div class="section">
    <label for="weight">체중 (kg): </label>
    <input type="number" id="weight" placeholder="체중 입력" />
  </div>

  <div class="drug-buttons section">
    <button class="btn drug-blue" data-drug="Norepinephrine">Norepinephrine / Epinephrine</button>
    <button class="btn drug-blue" data-drug="Phenylephrine">Phenylephrine</button>
    <button class="btn drug-blue" data-drug="Dopamine">Dopamine / Dobutamine</button>
    <button class="btn drug-blue" data-drug="NTG">Nitroglycerin</button>
    <button class="btn drug-pink" data-drug="Byfavo">Remimazolam (Byfavo)</button>
    <button class="btn drug-pink" data-drug="Precedex">Precedex (4mcg/ml)</button>
  </div>

  <div id="concentration-section" class="section concentration-buttons"></div>
  <div id="dose-section" class="section dose-buttons"></div>

  <div class="result" id="result">💉 결과: </div>

  <script>
    const drugButtons = document.querySelectorAll(".drug-buttons .btn");
    const concentrationSection = document.getElementById("concentration-section");
    const doseSection = document.getElementById("dose-section");
    const resultBox = document.getElementById("result");
    const weightInput = document.getElementById("weight");

    let selectedDrug = "";
    let selectedConcentration = null;

    const drugConcentrations = {
      Norepinephrine: ["5", "10"],
      Phenylephrine: ["100"],
      Dopamine: ["2mg"],
      NTG: ["0.25"],
      Byfavo: ["1mg", "2mg"],
      Precedex: ["4"]
    };

    const drugDoses = {
      Norepinephrine: ["0.01", "0.02", "0.03", "0.04", "0.05", "0.06", "0.07", "0.08", "0.09", "0.1"],
      Phenylephrine: ["0.1", "0.2", "0.3", "0.4", "0.5", "0.6", "0.7", "0.8", "0.9", "1"],
      Dopamine: ["1", "2", "3", "4", "5", "10"],
      NTG: ["0.5", "1", "2"],
      Precedex: ["0.1", "0.2", "0.3", "0.4", "0.5", "0.6", "0.7", "0.8", "0.9", "1.0"]
    };

    const byfavoDoses = [
      { label: "마취유도 6~12mg/kg/hr", min: 6, max: 12 },
      { label: "마취유지 1~2mg/kg/hr", min: 1, max: 2 },
      { label: "MAC 0.1~0.2mg/kg/hr", min: 0.1, max: 0.2 }
    ];

    drugButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        drugButtons.forEach(b => b.classList.remove("selected"));
        btn.classList.add("selected");
        selectedDrug = btn.dataset.drug;
        showConcentrationButtons();
        doseSection.innerHTML = "";
        resultBox.innerHTML = "💉 결과: ";
      });
    });

    function showConcentrationButtons() {
      concentrationSection.innerHTML = "";
      const list = drugConcentrations[selectedDrug];
      list.forEach(value => {
        const btn = document.createElement("button");
        btn.className = "btn concentration-btn";
        btn.innerText = `${value} ${selectedDrug === "Byfavo" || selectedDrug === "Dopamine" ? "mg/ml" : "mcg/ml"}`;
        btn.addEventListener("click", () => {
          document.querySelectorAll(".concentration-btn").forEach(b => b.classList.remove("selected"));
          btn.classList.add("selected");
          selectedConcentration = parseFloat(value);
          showDoseButtons();
        });
        concentrationSection.appendChild(btn);
      });
    }

    function showDoseButtons() {
      doseSection.innerHTML = "";
      const wt = parseFloat(weightInput.value);
      if (!wt || !selectedConcentration) return;

      if (selectedDrug === "Byfavo") {
        byfavoDoses.forEach(({ label, min, max }) => {
          const btn = document.createElement("button");
          btn.className = "btn dose-btn";
          btn.innerText = label;
          btn.addEventListener("click", () => {
            const minRate = (wt * min / selectedConcentration).toFixed(2);
            const maxRate = (wt * max / selectedConcentration).toFixed(2);
            resultBox.innerHTML = `💉 결과: ${minRate} ~ ${maxRate} ml/hr`;
          });
          doseSection.appendChild(btn);
        });
        return;
      }

      const doses = drugDoses[selectedDrug] || [];
      doses.forEach(dose => {
        const btn = document.createElement("button");
        btn.className = "btn dose-btn";
        btn.innerText = dose;
        btn.addEventListener("click", () => {
          const rate = (wt * parseFloat(dose) / selectedConcentration).toFixed(2);
          resultBox.innerHTML = `💉 결과: ${rate} ml/hr`;
        });
        doseSection.appendChild(btn);
      });
    }
  </script>
</body>
</html>

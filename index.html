
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>약물 계산기</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 500px;
      margin: auto;
    }
    h2 {
      text-align: center;
      margin-bottom: 10px;
    }
    .input-group {
      margin-bottom: 10px;
    }
    .input-group label {
      display: block;
      margin-bottom: 5px;
    }
    input[type="number"] {
      width: 100%;
      padding: 8px;
      font-size: 16px;
      box-sizing: border-box;
    }
    .button-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-bottom: 10px;
    }
    .drug-button {
      padding: 10px;
      font-size: 14px;
      border: none;
      border-radius: 5px;
      color: white;
      cursor: pointer;
    }
    .blue-button { background-color: #7fbfff; }
    .blue-button.selected { background-color: #007acc; }
    .pink-button { background-color: #f7cce9; }
    .pink-button.selected { background-color: #a2006d; }
    .dose-options, .concentration-options {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 10px;
    }
    .option-button {
      padding: 6px 12px;
      font-size: 14px;
      border-radius: 5px;
      background-color: #eee;
      color: black;
      cursor: pointer;
      border: 1px solid #aaa;
    }
    .option-button.selected {
      background-color: #444;
      color: yellow;
    }
    #result {
      margin-top: 20px;
      font-size: 20px;
      font-weight: bold;
      color: darkred;
      text-align: center;
    }
  </style>
</head>
<body>
  <h2>약물 계산기</h2>

  <div class="input-group">
    <label for="weight">체중 (kg)</label>
    <input type="number" id="weight" placeholder="체중을 입력하세요" />
  </div>

  <div class="button-grid" id="drugButtons">
    <button class="drug-button blue-button" data-drug="Norepi/Epi">Norepi/Epi</button>
    <button class="drug-button blue-button" data-drug="Phenyl">Phenyl</button>
    <button class="drug-button blue-button" data-drug="Dopa/Dobu">Dopa/Dobu</button>
    <button class="drug-button blue-button" data-drug="NTG">NTG</button>
    <button class="drug-button pink-button" data-drug="Byfavo">Byfavo</button>
    <button class="drug-button pink-button" data-drug="Precedex">Precedex</button>
  </div>

  <div class="concentration-options" id="concentrationOptions"></div>
  <div class="dose-options" id="doseOptions"></div>

  <div id="result"></div>

  <script>
    const drugButtons = document.querySelectorAll('.drug-button');
    const concentrationOptions = document.getElementById('concentrationOptions');
    const doseOptions = document.getElementById('doseOptions');
    const resultDisplay = document.getElementById('result');

    const concentrations = {
      "Norepi/Epi": ["5 mcg/ml", "10 mcg/ml"],
      "Phenyl": ["100 mcg/ml"],
      "Dopa/Dobu": ["2 mg/ml"],
      "NTG": ["0.25 mg/ml"],
      "Byfavo": ["1 mg/ml", "2 mg/ml"],
      "Precedex": ["4 mcg/ml"]
    };

    const doses = {
      "Norepi/Epi": ["0.01", "0.02", "0.03", "0.04", "0.05", "0.06", "0.07", "0.08", "0.09", "0.1"],
      "Phenyl": ["0.1", "0.2", "0.3", "0.4", "0.5", "0.6", "0.7", "0.8", "0.9", "1.0"],
      "Dopa/Dobu": ["1", "2", "3", "4", "5", "10"],
      "NTG": ["0.5", "1", "2"],
      "Precedex": ["0.1", "0.2", "0.3", "0.4", "0.5", "0.6", "0.7", "0.8", "0.9", "1.0"],
      "Byfavo": ["마취유도", "마취유지", "MAC 0.1", "MAC 0.2"]
    };

    let selectedDrug = "";
    let selectedConc = "";
    let selectedDose = "";

    drugButtons.forEach(button => {
      button.addEventListener('click', () => {
        drugButtons.forEach(btn => btn.classList.remove('selected'));
        button.classList.add('selected');
        selectedDrug = button.dataset.drug;
        selectedConc = "";
        selectedDose = "";
        renderConcentrations();
        renderDoses();
        resultDisplay.textContent = "";
      });
    });

    function renderConcentrations() {
      concentrationOptions.innerHTML = "";
      (concentrations[selectedDrug] || []).forEach(conc => {
        const btn = document.createElement('button');
        btn.textContent = conc;
        btn.className = "option-button";
        btn.addEventListener('click', () => {
          document.querySelectorAll('.concentration-options .option-button').forEach(b => b.classList.remove('selected'));
          btn.classList.add('selected');
          selectedConc = conc;
        });
        concentrationOptions.appendChild(btn);
      });
    }

    function renderDoses() {
      doseOptions.innerHTML = "";
      (doses[selectedDrug] || []).forEach(dose => {
        const btn = document.createElement('button');
        btn.textContent = dose;
        btn.className = "option-button";
        btn.addEventListener('click', () => {
          document.querySelectorAll('.dose-options .option-button').forEach(b => b.classList.remove('selected'));
          btn.classList.add('selected');
          selectedDose = dose;
          calculateInfusionRate();
        });
        doseOptions.appendChild(btn);
      });
    }

    function calculateInfusionRate() {
      const weight = parseFloat(document.getElementById('weight').value);
      if (!weight || !selectedConc || !selectedDose) return;

      let doseVal = parseFloat(selectedDose);
      let concVal = parseFloat(selectedConc);
      let unit = selectedConc.includes("mg") ? 1000 : 1;
      let hrRate = (weight * doseVal * 60) / (concVal * unit);
      resultDisplay.textContent = `${hrRate.toFixed(2)} ml/hr`;
    }
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>약물 계산기</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 20px;
            background-color: #f9f9f9;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        .section {
            margin-bottom: 20px;
        }
        .title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .button-group {
            display: grid;
            gap: 10px;
            margin-top: 10px;
        }
        .drug-buttons { grid-template-columns: repeat(3, 1fr); }
        .dose-buttons { grid-template-columns: repeat(5, 1fr); }
        .concentration-buttons { grid-template-columns: repeat(3, 1fr); }
        .button {
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        .drug { background-color: #e0f0ff; color: #000; }
        .drug.selected { background-color: #3399ff; color: #fff; }
        .concentration { background-color: #eee; }
        .concentration.selected { background-color: #888; color: #fff; }
        .dose { background-color: #d9f8e3; }
        .dose.selected { background-color: #33aa55; color: #fff; }
        .pink { background-color: #ffe0f0; }
        .pink.selected { background-color: #cc3388; color: #fff; }
        #result { font-weight: bold; color: red; margin-top: 15px; }
        input[type="number"] {
            padding: 8px;
            width: 100%;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="section">
            <div class="title">1. 약물 선택</div>
            <div class="button-group drug-buttons" id="drug-buttons">
                <button class="button drug" data-drug="Norepi">Norepinephrine</button>
                <button class="button drug" data-drug="Phenyl">Phenylephrine</button>
                <button class="button drug" data-drug="Dopa">Dopamine</button>
                <button class="button drug" data-drug="Dobu">Dobutamine</button>
                <button class="button drug" data-drug="NTG">Nitroglycerin</button>
                <button class="button pink" data-drug="Byfavo">Remimazolam(Byfavo)</button>
                <button class="button pink" data-drug="Precedex">Precedex</button>
                <button class="button drug" data-drug="Epi">Epinephrine</button>
            </div>
        </div>
        <div class="section">
            <div class="title">2. 체중 입력 (kg)</div>
            <input type="number" id="weight" min="1" max="200" />
        </div>
        <div class="section">
            <div class="title">3. 농도 선택</div>
            <div class="button-group concentration-buttons" id="concentration-buttons">
                <!-- Buttons will be inserted by JS -->
            </div>
        </div>
        <div class="section">
            <div class="title">4. 용량 선택</div>
            <div class="button-group dose-buttons" id="dose-buttons">
                <!-- Buttons will be inserted by JS -->
            </div>
        </div>
        <div class="section">
            <div id="result">결과: </div>
        </div>
    </div>
    <script>
        const drugButtons = document.querySelectorAll(".drug, .pink");
        const concContainer = document.getElementById("concentration-buttons");
        const doseContainer = document.getElementById("dose-buttons");
        const resultBox = document.getElementById("result");
        const weightInput = document.getElementById("weight");

        let selectedDrug = "";
        let selectedConc = null;
        let selectedDose = null;

        const concentrations = {
            "Norepi": [5, 10],
            "Phenyl": [0.1, 0.2, 0.5],
            "Dopa": [2],
            "Dobu": [2],
            "NTG": [0.25],
            "Byfavo": [2],
            "Precedex": [],
            "Epi": [5, 10],
        };

        const doses = {
            "Norepi": [0.01, 0.02, 0.03, 0.04, 0.05],
            "Phenyl": [0.1, 0.2, 0.3, 0.4],
            "Dopa": [1, 2, 3, 4, 5],
            "Dobu": [1, 2, 3, 4, 5],
            "NTG": [0.5, 1, 2, 4],
            "Byfavo": [6, 8, 10, 12, 1, 2],
            "Precedex": [0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1],
            "Epi": [0.01, 0.02, 0.03, 0.04, 0.05]
        };

        function updateConcentrations() {
            concContainer.innerHTML = "";
            if (!concentrations[selectedDrug]) return;
            concentrations[selectedDrug].forEach((val) => {
                const btn = document.createElement("button");
                btn.className = "button concentration";
                btn.innerText = `${val} mcg/mL`;
                btn.onclick = () => {
                    selectedConc = val;
                    [...concContainer.children].forEach(b => b.classList.remove("selected"));
                    btn.classList.add("selected");
                    updateResult();
                };
                concContainer.appendChild(btn);
            });
        }

        function updateDoses() {
            doseContainer.innerHTML = "";
            if (!doses[selectedDrug]) return;
            doses[selectedDrug].forEach((val) => {
                const btn = document.createElement("button");
                btn.className = "button dose";
                btn.innerText = `${val}`;
                btn.onclick = () => {
                    selectedDose = val;
                    [...doseContainer.children].forEach(b => b.classList.remove("selected"));
                    btn.classList.add("selected");
                    updateResult();
                };
                doseContainer.appendChild(btn);
            });
        }

        function updateResult() {
            const wt = parseFloat(weightInput.value);
            if (!wt || !selectedDose) return;

            let mcgPerHr = wt * selectedDose;
            let mlPerHr = 0;

            if (selectedDrug === "Precedex") {
                mlPerHr = mcgPerHr / 4;
            } else if (selectedConc) {
                mlPerHr = mcgPerHr / selectedConc;
            } else {
                return;
            }

            const rounded = Math.round(mlPerHr * 10) / 10;
            resultBox.innerText = `결과: ${rounded % 1 === 0 ? rounded.toFixed(0) : rounded} ml/hr`;
        }

        drugButtons.forEach(btn => {
            btn.onclick = () => {
                drugButtons.forEach(b => b.classList.remove("selected"));
                btn.classList.add("selected");
                selectedDrug = btn.getAttribute("data-drug");
                selectedConc = null;
                selectedDose = null;
                updateConcentrations();
                updateDoses();
                resultBox.innerText = "결과: ";
            };
        });
    </script>
</body>
</html>
